<!DOCTYPE html>
<html lang="en-US">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="ttw" content="cfanq3r">


<title>Creating a JavaScript promise from scratch, Part 4: Promise.resolve() and Promise.reject() - Human Who Codes</title>
<meta name="twitter:site" content="@humanwhocodes">
<meta name="twitter:creator" content="@slicknet">
<meta name="twitter:url" content="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/" />
<meta name="twitter:image" content="https://humanwhocodes.com/images/favicon.png" />
<meta name="twitter:image:alt" content="Human Who Codes" />
<meta name="twitter:title" content="Creating a JavaScript promise from scratch, Part 4: Promise.resolve() and Promise.reject()">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">

<meta name="og:image" content="https://humanwhocodes.com/images/favicon.png" />
<meta name="og:url" content="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/" />
<meta name="og:title" content="Creating a JavaScript promise from scratch, Part 4: Promise.resolve() and Promise.reject()">
<meta name="og:description" content="">
<meta name="og:type" content="article">



<link rel="stylesheet" href="../../../../styles/index.css" type="text/css" media="screen">
<link rel="alternate" type="application/rss+xml" title="Human Who Codes - Blog" href="../../../../feeds/blog.xml">
<link rel="alternate" type="application/json" title="Human Who Codes - Blog" href="../../../../feeds/blog.json">
<link rel="alternate" type="application/rss+xml" title="Human Who Codes - Snippets" href="../../../../feeds/snippets.xml">
<link rel="alternate" type="application/json" title="Human Who Codes - Snippets" href="../../../../feeds/snippets.json">
<link rel="alternate" type="application/rss+xml" title="Human Who Codes - Everything" href="../../../../feeds/all.xml">
<link rel="alternate" type="application/json" title="Human Who Codes - Everything" href="../../../../feeds/all.json">
<link rel="icon" type="image/png" href="../../../../images/favicon.png">


<link rel="canonical" href="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/index.html">



<meta name="description" content="When you create a promise with the Promise constructor, you’re creating an unsettled promise, meaning the promise state is pending until either the resolve or reject function is called inside the constructor. You...">
<meta name="keywords" content="JavaScript,Promises,ECMAScript 6,Nicholas,Zakas,NCZOnline">

<script src="../../../../scripts/emailform.js" async></script>
</head>
<body itemscope itemtype="http://schema.org/WebPage">
    <header class="highlight-background">
        <nav role="navigation" class="page-width center center-text gutters collapsible-corners">
            <h1 class="no-margin"><a href="https://humanwhocodes.com/"><img src="../../../../images/logo-full-web.svg" alt="Human Who Codes" height="50"></a></h1>
            <ul class="inline-list inline-spaced-list center-text-on-small-screens overflow-x-scroll bigger-font all-caps bold">
                <li class="hide-offscreen"><a href="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/index.html#content">Skip to content</a></li>
                <li><a href="https://humanwhocodes.com/books/" class="dark-text no-underline">Books</a></li>
                <li><a href="https://humanwhocodes.com/reading/" class="dark-text no-underline">Reading</a></li>
                <!-- <li><a href="/speaking/" class="dark-text no-underline">Speaking</a></li> -->
                <li><a href="https://humanwhocodes.com/donate/" class="dark-text no-underline">Donate</a></li>
                <li><a href="https://humanwhocodes.com/contact/" class="dark-text no-underline">Contact</a></li>
            </ul>
        </nav>
    </header>
    <hr>
    <div class="content-background">
        <div id="page-grid" class="page-width page-grid center">
            <main id="content" role="main" class="content-width gutters">

<article itemtype="http://schema.org/Article">
    <header>
        <h1 itemprop="headline" class="no-margin gutter-bottom headline-text">Creating a JavaScript promise from scratch, Part 4: Promise.resolve() and Promise.reject()</h1>
        <p itemprop="description" class="no-margin-top">Promises created with Promise.resolve() and Promise.reject() go through a different process than when created with a constructor.</p>
        <div class="post-meta gutter-top smaller-font dark-dotted-border-top dark-dotted-border-bottom">
            <p class="no-margin byline">Posted at <time datetime="2020-10-13T00:00:00+00:00" itemprop="datePublished">October 13, 2020</time> by <span itemprop="author" itemtype="http://schema.org/Person">Nicholas
                    C. Zakas</span></p>
            <p class="no-margin-top tags">Tags:
                
                <a href="https://humanwhocodes.com/blog/tag/javascript" rel="tag">JavaScript</a>,
                
                <a href="https://humanwhocodes.com/blog/tag/promises" rel="tag">Promises</a>,
                
                <a href="https://humanwhocodes.com/blog/tag/ecmascript-6" rel="tag">ECMAScript 6</a>
                
            </p>
        </div>
    </header>
    <section id="post-body" class="content-font">
        
<p>When you create a promise with the <code class="highlighter-rouge">Promise</code> constructor, you’re creating an <em>unsettled promise</em>, meaning the promise state is pending until either the <code class="highlighter-rouge">resolve</code> or <code class="highlighter-rouge">reject</code> function is called inside the constructor. You can also created promises by using the <code class="highlighter-rouge">Promise.resolve()</code> and <code class="highlighter-rouge">Promise.reject()</code> methods, in which case, the promises might already be fulfilled or rejected as soon as they are created. These methods are helpful for wrapping known values in promises without going through the trouble of defining an executor function. However, <code class="highlighter-rouge">Promise.resolve()</code> doesn’t directly map to <code class="highlighter-rouge">resolve</code> inside an executor, and <code class="highlighter-rouge">Promise.reject()</code> doesn’t directly map to <code class="highlighter-rouge">reject</code> inside an executor.</p>

<p>Note: This is the fourth post in my series about creating JavaScript promises from scratch. If you haven’t already read the <a href="http://127.0.0.1:8000/blog/2020/09/creating-javascript-promise-from-scratch-constructor/index.html">first post</a>, the <a href="http://127.0.0.1:8000/blog/2020/09/creating-javascript-promise-from-scratch-resolving-to-a-promise/index.html">second post</a>, and the <a href="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-then-catch-finally/index.html">third post</a>, I would suggest you do so because this post builds on the topics covered in those posts.</p>

<p>As a reminder, this series is based on my promise library, <a href="https://github.com/humanwhocodes/pledge">Pledge</a>. You can view and download all of the source code from GitHub.</p>

<h2 id="the-promiseresolve-method">The <code class="highlighter-rouge">Promise.resolve()</code> method</h2>

<p>The purpose of the <code class="highlighter-rouge">Promise.resolve()</code> method is to return a promise that resolves to a given argument. However, there is some nuanced behavior around what it ends up returning:</p>

<ol>
  <li>If the argument isn’t a promise, a new fulfilled promise is returned where the fulfillment value is the argument.</li>
  <li>If the argument is a promise and the promise’s constructor is different than the <code class="highlighter-rouge">this</code> value inside of <code class="highlighter-rouge">Promise.resolve()</code>, then a new promise is created using the <code class="highlighter-rouge">this</code> value and that promise is set to resolve when the argument promise resolves.</li>
  <li>If the argument is a promise and the promise’s constructor is the same as the <code class="highlighter-rouge">this</code> value inside of <code class="highlighter-rouge">Promise.resolve()</code>, then the argument promise is returned and no new promise is created.</li>
</ol>

<p>Here are some examples to illustrate these cases:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// non-promise value</span>
<span class="kd">const</span> <span class="nx">promise1</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise1</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">===</span> <span class="nb">Promise</span><span class="p">);</span>  <span class="c1">// true</span>

<span class="c1">// promise with the same constructor</span>
<span class="kd">const</span> <span class="nx">promise2</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">promise1</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise2</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">===</span> <span class="nb">Promise</span><span class="p">);</span>  <span class="c1">// true</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise2</span> <span class="o">===</span> <span class="nx">promise1</span><span class="p">);</span>             <span class="c1">// true</span>

<span class="c1">// promise with a different constructor</span>
<span class="kd">class</span> <span class="nx">MyPromise</span> <span class="kd">extends</span> <span class="nb">Promise</span> <span class="p">{}</span>

<span class="kd">const</span> <span class="nx">promise3</span> <span class="o">=</span> <span class="nx">MyPromise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">promise4</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">promise3</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise3</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">===</span> <span class="nx">MyPromise</span><span class="p">);</span> <span class="c1">// true</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise4</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">===</span> <span class="nb">Promise</span><span class="p">);</span>      <span class="c1">// true</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise3</span> <span class="o">===</span> <span class="nx">promise4</span><span class="p">);</span>                 <span class="c1">// false</span>
</code></pre></div></div>

<p>In this code, passing <code class="highlighter-rouge">42</code> to <code class="highlighter-rouge">Promise.resolve()</code> results in a new fulfilled promise, <code class="highlighter-rouge">promise1</code> that was created using the <code class="highlighter-rouge">Promise</code> constructor. In the second part, <code class="highlighter-rouge">promise1</code> is passed to <code class="highlighter-rouge">Promise.resolve()</code> and the returned promise, <code class="highlighter-rouge">promise2</code>, is actually just <code class="highlighter-rouge">promise1</code>. This is a shortcut operation because there is no reason to create a new instance of the same class of promise to represent the same fulfillment value. In the third part, <code class="highlighter-rouge">MyPromise</code> extends <code class="highlighter-rouge">Promise</code> to create a new class. The <code class="highlighter-rouge">MyPromise.resolve()</code> method creates an instance of <code class="highlighter-rouge">MyPromise</code> because the <code class="highlighter-rouge">this</code> value inside of <code class="highlighter-rouge">MyPromise.resolve()</code> determines the constructor to use when creating a new promise. Because <code class="highlighter-rouge">promise3</code> was created with the <code class="highlighter-rouge">Promise</code> constructor, <code class="highlighter-rouge">Promise.resolve()</code> needs to create a new instance of <code class="highlighter-rouge">Promise</code> that resolves when <code class="highlighter-rouge">promise3</code> is resolved.</p>

<p>The important thing to keep in mind that the <code class="highlighter-rouge">Promise.resolve()</code> method always returns a promise created with the <code class="highlighter-rouge">this</code> value inside. This ensures that for any given <code class="highlighter-rouge">X.resolve()</code> method, where <code class="highlighter-rouge">X</code> is a subclass of <code class="highlighter-rouge">Promise</code>, returns an instance of <code class="highlighter-rouge">X</code>.</p>

<h3 id="creating-the-pledgeresolve-method">Creating the <code class="highlighter-rouge">Pledge.resolve()</code> method</h3>

<p>The specification<sup id="fnref:1"><a href="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/index.html#fn:1" class="footnote">1</a></sup> defines a simple, three-step process for the <code class="highlighter-rouge">Promise.resolve()</code> method:</p>

<ol>
  <li>Let <code class="highlighter-rouge">C</code> be the <code class="highlighter-rouge">this</code> value.</li>
  <li>If <code class="highlighter-rouge">Type(C)</code> is not <code class="highlighter-rouge">Object</code>, throw a <code class="highlighter-rouge">TypeError</code> exception.</li>
  <li>Return <code class="highlighter-rouge">?</code> <code class="highlighter-rouge">PromiseResolve(C, x)</code>.</li>
</ol>

<p>As with many of the methods discussed in this blog post series, <code class="highlighter-rouge">Promise.resolve()</code> delegates much of the work to another operation called <code class="highlighter-rouge">PromiseResolve()</code><sup id="fnref:2"><a href="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/index.html#fn:2" class="footnote">2</a></sup>, which I’ve implemented as <code class="highlighter-rouge">pledgeResolve()</code>. The actual code for <code class="highlighter-rouge">Pledge.resolve()</code> is therefore quite succinct:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">Pledge</span> <span class="p">{</span>

    <span class="c1">// other methods omitted for space</span>

    <span class="kd">static</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>

        <span class="kd">const</span> <span class="nx">C</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">C</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cannot call resolve() without `this` value.</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">pledgeResolve</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// other methods omitted for space</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You were introduced to the the <code class="highlighter-rouge">pledgeResolve()</code> function in the third post in the series, and I’ll show it here again for context:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">pledgeResolve</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">assertIsObject</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">isPledge</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">xConstructor</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="kd">constructor</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="nx">xConstructor</span><span class="p">,</span> <span class="nx">C</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">pledgeCapability</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PledgeCapability</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span>
    <span class="nx">pledgeCapability</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">pledgeCapability</span><span class="p">.</span><span class="nx">pledge</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>When used in the <code class="highlighter-rouge">finally()</code> method, the <code class="highlighter-rouge">C</code> argument didn’t make a lot of sense, but here you can see that it’s important to ensure the correct constructor is used from <code class="highlighter-rouge">Pledge.resolve()</code>. So if <code class="highlighter-rouge">x</code> is an instance of <code class="highlighter-rouge">Pledge</code>, then you need to check to see if its constructor is also <code class="highlighter-rouge">C</code>, and if so, just return <code class="highlighter-rouge">x</code>. Otherwise, the <code class="highlighter-rouge">PledgeCapability</code> class is once again used to create an instance of the correct class, resolve it to <code class="highlighter-rouge">x</code>, and then return that instance.</p>

<p>With <code class="highlighter-rouge">Promise.resolve()</code> fully implemented as <code class="highlighter-rouge">Pledge.resolve()</code> in the Pledge library, it’s now time to move on to <code class="highlighter-rouge">Pledge.reject()</code>.</p>

<h2 id="the-promisereject-method">The <code class="highlighter-rouge">Promise.reject()</code> method</h2>

<p>The <code class="highlighter-rouge">Promise.reject()</code> method behaves similarly to <code class="highlighter-rouge">Promise.resolve()</code> in that you pass in a value and the method returns a promise that wraps that value. In the case of <code class="highlighter-rouge">Promise.reject()</code>, though, the promise is in a rejected state and the reason is the argument that was passed in. The biggest difference from <code class="highlighter-rouge">Promise.resolve()</code> is that there is no additional check to see if the reason is a promise that has the same constructor; <code class="highlighter-rouge">Promise.reject()</code> always creates and returns a new promise, so there is no reason to do such a check. Otherwise, <code class="highlighter-rouge">Promise.reject()</code> mimics the behavior of <code class="highlighter-rouge">Promise.resolve()</code>, including using the <code class="highlighter-rouge">this</code> value to determine the class to use when returning a new promise. Here are some examples:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// non-promise value</span>
<span class="kd">const</span> <span class="nx">promise1</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="mi">43</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise1</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">===</span> <span class="nb">Promise</span><span class="p">);</span>  <span class="c1">// true</span>

<span class="c1">// promise with the same constructor</span>
<span class="kd">const</span> <span class="nx">promise2</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="nx">promise1</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise2</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">===</span> <span class="nb">Promise</span><span class="p">);</span>  <span class="c1">// true</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise2</span> <span class="o">===</span> <span class="nx">promise1</span><span class="p">);</span>             <span class="c1">// false</span>

<span class="c1">// promise with a different constructor</span>
<span class="kd">class</span> <span class="nx">MyPromise</span> <span class="kd">extends</span> <span class="nb">Promise</span> <span class="p">{}</span>

<span class="kd">const</span> <span class="nx">promise3</span> <span class="o">=</span> <span class="nx">MyPromise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="mi">43</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">promise4</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="nx">promise3</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise3</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">===</span> <span class="nx">MyPromise</span><span class="p">);</span> <span class="c1">// true</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise4</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">===</span> <span class="nb">Promise</span><span class="p">);</span>      <span class="c1">// true</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">promise3</span> <span class="o">===</span> <span class="nx">promise4</span><span class="p">);</span>                 <span class="c1">// false</span>
</code></pre></div></div>

<p>Once again, <code class="highlighter-rouge">Promise.reject()</code> doesn’t do any inspection of the reason passed in and always returns a new promise, <code class="highlighter-rouge">promise2</code> is not the same as <code class="highlighter-rouge">promise1</code>. And the promise returned from <code class="highlighter-rouge">MyPromise.reject()</code> is an instance of <code class="highlighter-rouge">MyPromise</code> rather than <code class="highlighter-rouge">Promise</code>, fulfilling the requirement that <code class="highlighter-rouge">X.reject()</code> always returns an instance of <code class="highlighter-rouge">X</code>.</p>

<h3 id="creating-the-pledgereject-method">Creating the <code class="highlighter-rouge">Pledge.reject()</code> method</h3>

<p>According to the specification<sup id="fnref:3"><a href="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/index.html#fn:3" class="footnote">3</a></sup>, the following steps must be taken when <code class="highlighter-rouge">Promise.reject()</code> is called with an argument <code class="highlighter-rouge">r</code>:</p>

<ol>
  <li>Let <code class="highlighter-rouge">C</code> be the <code class="highlighter-rouge">this</code> value.</li>
  <li>Let <code class="highlighter-rouge">promiseCapability</code> be <code class="highlighter-rouge">?</code> <code class="highlighter-rouge">NewPromiseCapability(C)</code>.</li>
  <li>Perform <code class="highlighter-rouge">?</code> <code class="highlighter-rouge">Call(promiseCapability.[[Reject]], undefined, « r »)</code>.</li>
  <li>Return <code class="highlighter-rouge">promiseCapability.[[Promise]]</code>.</li>
</ol>

<p>Fortunately, converting this algorithm into JavaScript is straightforward:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">Pledge</span> <span class="p">{</span>

    <span class="c1">// other methods omitted for space</span>

    <span class="kd">static</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="kd">const</span> <span class="nx">C</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="kd">const</span> <span class="nx">capability</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PledgeCapability</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span>
        <span class="nx">capability</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">capability</span><span class="p">.</span><span class="nx">pledge</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// other methods omitted for space</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This method is similar to <code class="highlighter-rouge">pledgeResolve()</code> with the two notable exceptions: there is no check to see what type of value <code class="highlighter-rouge">r</code> and the <code class="highlighter-rouge">capability.reject()</code> method is called instead of <code class="highlighter-rouge">capability.resolve()</code>. All of the work is done inside of <code class="highlighter-rouge">PledgeCapability</code>, once again highlighting how important this part of the specification is to promises as a whole.</p>

<h2 id="wrapping-up">Wrapping Up</h2>

<p>This post covered creating <code class="highlighter-rouge">Promise.resolve()</code> and <code class="highlighter-rouge">Promise.reject()</code> from scratch. These methods are important for converting from non-promise values into promises, which is used in a variety of ways in JavaScript. For example, the <code class="highlighter-rouge">await</code> operator calls <code class="highlighter-rouge">PromiseResolve()</code> to ensure its operand is a promise. So while these two methods are a lot simpler than the ones covered in my previous posts, they are equally as important to how promises work as a whole.</p>

<p>All of this code is available in the <a href="https://github.com/humanwhocodes/pledge">Pledge</a> on GitHub. I hope you’ll download it and try it out to get a better understanding of promises.</p>

<h2 id="want-more-posts-in-this-series">Want more posts in this series?</h2>

<p>So far, I’ve covered the basic ways that promises work, but there’s still more to cover. If you are enjoying this series and would like to see it continue, please <a href="https://github.com/sponsors/nzakas">sponsor me</a> on GitHub. For every five new sponsors I receive, I’ll release a new post. Here’s what I plan on covering:</p>

<ul>
  <li>Part 5: <code class="highlighter-rouge">Promise.race()</code> and <code class="highlighter-rouge">Promise.any()</code> (when I have 35 sponsors)</li>
  <li>Part 6: <code class="highlighter-rouge">Promise.all()</code> and <code class="highlighter-rouge">Promise.allSettled()</code> (when I have 40 sponsors)</li>
  <li>Part 7: Unhandled promise rejection tracking (when I have 45 sponsors)</li>
</ul>

<p>It takes a significant amount of time to put together posts like these, and I appreciate your consideration in helping me continue to create quality content like this.</p>

<h2 id="references">References</h2>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p><a href="https://www.ecma-international.org/ecma-262/#sec-promise.resolve">Promise.resolve( x )</a> <a href="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/index.html#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p><a href="https://www.ecma-international.org/ecma-262/#sec-promise-resolve">PromiseResolve( C, x )</a> <a href="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/index.html#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p><a href="https://www.ecma-international.org/ecma-262/11.0/index.html#sec-promise.reject">Promise.reject( r )</a> <a href="http://127.0.0.1:8000/blog/2020/10/creating-javascript-promise-from-scratch-promise-resolve-reject/index.html#fnref:3" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

<!--
<div class="center-text">


</div>-->
    </section>
    <footer>
        <div class="gutters round-borders cta-background margin-bottom">
            <h3 class="no-margin-top">Was this helpful?</h3>
            <p>If you found this post helpful, please consider donating to support my work.</p>
            <ul class="inline-list grid-columns">
                <li class="center-text"><a href="https://github.com/users/nzakas/sponsorship" class="link-btn cta-btn">Donate with GitHub</a></li>
                <li class="center-text"><a href="https://www.paypal.com/donate/?token=QV5gLG9Q5szfku7XrfOVQLxk25R5wYQgS5Li_q0si6WRF_XYkhpV6DM0pTIkyQtXDW00tW&country.x=US&locale.x=US" class="link-btn cta-btn">Donate with PayPal</a></li>
            </ul>
        </div>
    </footer>
<!--
    <footer class="media-box gutters round-borders cta-background margin-bottom">
        <div class="media-box-media">
            <a href="/donate" class="link-btn cta-btn">Donate</a>
        </div>
        <div>
            <p class="no-margin"><b>Was this helpful?</b> If you found this post helpful, I would very much appreciate your support. Donations of any amount gratefully accepted.</p>
        </div>
    </footer>
-->
</article>

<div class="grid-columns">
    <div class="gutters round-borders content-item-border highlight-background">
        
        <h2 class="no-margin-top">New in the Store</h2>
<p><a href="https://teespring.com/stores/humanwhocodes?utm_source=humanwhocodes&utm_campaign=postmodule"><img 
    src="../../../../images/shirts/spark-joy-sincere-250.png" 
    alt="My Code Sparks Joy (Sincerity) T-shirt" height="250"></a></p>

    </div>
    <div class="gutters round-borders content-item-border highlight-background">
        <h2 class="no-margin-top">Join the Mailing List</h2>
        <p>Never miss an update by joining 3,000 other mailing list members.</p>
        <form method="post" name="sideemailform" action="https://mailinglist.humanwhocodes.com/api/subscribe">
            <div id="mc_embed_signup_scroll">
                <div style="margin-bottom: 0.5em">
                    <label>First name:
                        <input type="text" value="" style="width:100%" name="firstName">
                    </label>
                </div>
                <div style="margin-bottom: 0.5em">
                    <label>Last name:
                        <input type="text" value="" style="width:100%" name="lastName">
                    </label>
                </div>
                <div>
                    <label>Email address:
                        <input type="email" value="" style="width:100%" name="email" required>
                    </label>
                </div>
                <input type="hidden" name="formId" value="1408574">
                <div class="center-text gutters">
                    <input type="submit" value="Subscribe">
                </div>
            </div>
        </form>
    </div>
</div>




        </main>

        <div id="sidebar" class="sidebar-width sidebar-background gutters hide-on-small-screens">
            <h1 class="hide-offscreen">Additional Information</h1>
            <script async type="text/javascript" src="https://cdn.carbonads.com/carbon.js?serve=CKYIEK3Y&amp;placement=humanwhocodescom" id="_carbonads_js"></script>
        
            
            
            <h2 class="smaller-font">Top Sponsors</h2>
            <ul class="inline-list inline-image-list">
                
                <li><a href="https://github.com/scoutapm-sponsorships"><img src="https://avatars.githubusercontent.com/u/71095532?u=9f5a794ddc3b67ba057ee65e7ce166ad205a76c2&v=4" alt="Scout APM Sponsorships" width="90" style="padding: 5px; border-radius: 50%"></a></li>
                
            </ul>
            

            <h2 class="smaller-font">My Books</h2>
            <ul class="inline-list inline-image-list">
                
                
                <li><a href="https://geni.us/hwc-es6-book"><img src="../../../../images/books/understandinges6ns.png" alt="Understanding ECMAScript 6" width="100"></a></li>
                
                <li><a href="https://geni.us/hwc-oopjs-book"><img src="../../../../images/books/oopinjsns.png" alt="The Principles of Object-Oriented JavaScript" width="100"></a></li>
                
                <li><a href="https://geni.us/hwc-mjs-book"><img src="../../../../images/books/maintainablejs.png" alt="Maintainable JavaScript" width="100"></a></li>
                
                <li><a href="https://amzn.to/2JBDt96"><img src="../../../../images/books/pro_js_3e.png" alt="Professional JavaScript for Web Developers, 3rd Edition" width="100"></a></li>
                
            </ul>
            <h2 class="smaller-font">Recent Snippets</h2>
            <ul class="">
                
                
                <li><a href="https://humanwhocodes.com/snippets/2021/03/create-user-linux-ssh-key/">Creating a new user with an SSH key on Linux</a></li>
                
                <li><a href="https://humanwhocodes.com/snippets/2021/02/how-to-setup-deploy-web-application-dokku/">How to setup and deploy a web application on Dokku</a></li>
                
                <li><a href="https://humanwhocodes.com/snippets/2021/02/how-to-regain-jenkins-web-access-after-lockout/">How to regain Jenkins web access after being locked out</a></li>
                
                <li><a href="https://humanwhocodes.com/snippets/2020/10/create-typescript-declarations-from-javascript-jsdoc/">Create TypeScript declarations from JavaScript and JSDoc</a></li>
                
                <li><a href="https://humanwhocodes.com/snippets/2020/10/read-environment-variables-deno/">How to read environment variables in Deno using JavaScript</a></li>
                
                <li><a href="https://humanwhocodes.com/snippets/2020/08/validate-github-webhook-signature-nodejs/">How to validate the signature of a GitHub webhook using Node.js</a></li>
                
                <li><a href="https://humanwhocodes.com/snippets/2020/07/eleventy-heading-ids/">How to generate ID attributes in headings using Eleventy</a></li>
                
                <li><a href="https://humanwhocodes.com/snippets/2020/02/optionally-await-function-result/">How to optionally await a JavaScript function call</a></li>
                
                <li><a href="https://humanwhocodes.com/snippets/2019/05/jest-globals-intellisense-visual-studio-code/">Setting up Visual Studio Code intellisense for Jest globals</a></li>
                
                <li><a href="https://humanwhocodes.com/snippets/2019/05/nodejs-read-stream-promise/">Reading streams with promises in Node.js</a></li>
                
            </ul>
            <h2 class="smaller-font">Archives</h2>
            <ul>


                <li><a href='https://humanwhocodes.com/blog/2021/'>2021</a></li>

                <li><a href='../../index.html'>2020</a></li>

                <li><a href='https://humanwhocodes.com/blog/2019/'>2019</a></li>

                <li><a href='https://humanwhocodes.com/blog/2018/'>2018</a></li>


                <li><a href='https://humanwhocodes.com/blog/2016/'>2016</a></li>

                <li><a href='https://humanwhocodes.com/blog/2015/'>2015</a></li>

                <li><a href='https://humanwhocodes.com/blog/2014/'>2014</a></li>

                <li><a href='https://humanwhocodes.com/blog/2013/'>2013</a></li>

                <li><a href='https://humanwhocodes.com/blog/2012/'>2012</a></li>

                <li><a href='https://humanwhocodes.com/blog/2011/'>2011</a></li>

                <li><a href='https://humanwhocodes.com/blog/2010/'>2010</a></li>

                <li><a href='https://humanwhocodes.com/blog/2009/'>2009</a></li>

                <li><a href='https://humanwhocodes.com/blog/2008/'>2008</a></li>

                <li><a href='https://humanwhocodes.com/blog/2007/'>2007</a></li>

                <li><a href='https://humanwhocodes.com/blog/2006/'>2006</a></li>

                <li><a href='https://humanwhocodes.com/blog/2005/'>2005</a></li>

                <li><a href='https://humanwhocodes.com/blog/2004/'>2004</a></li>

            </ul>

        </div> <!-- sidebar -->
    </div> <!-- page-grid -->
</div> <!-- content-background -->
<hr>
<footer class="inverted-colors">
    <div class="page-width center">
        <div class="page-grid orange-border-bottom">
            <div class="margin-top content-width gutters">
                <div class="collapsible-media-box">
                    <div class="media-box-media center-text">
                        <img src="../../../../images/me/me-150x150.jpg" alt="Photo of Nicholas C. Zakas" width="150" class="circle-image">
                    </div>
                    <div>
                        <h2 class="no-margin-top center-text-on-mobile">About the Human</h2>
                        <p>Hi, I'm Nicholas C. Zakas, an independent software developer living in Mountain View, California. 
                            I've been a software architect at companies like Yahoo and Box, as well as an author and speaker. 
                            I created the <a href="https://eslint.org">ESLint</a> open source project and wrote several 
                            <a href="https://humanwhocodes.com/books">books</a>. At the moment, I'm <a href="http://127.0.0.1:8000/blog/2014/04/02/i-have-lyme-disease/index.html">recovering from Lyme disease</a> 
                            and haven't been able to leave my home much in the past five years. (<a href="https://medium.com/lyme-disease-warrior/progress-report-october-2018-fc38d4769e65">Health update</a>, <a rel="me" href="../../../../about">More about me</a>)</p>
                    </div>
                </div>
            </div>
            <div class="margin-top sidebar-width hide-on-small-screens">
                <h2 class="no-margin-top">On the Web</h2>
                <ul>
                    <li><a href="https://www.twitter.com/slicknet/">Twitter</a></li>
                    <li><a href="https://www.github.com/nzakas/">GitHub</a></li>
                    <li><a href="https://www.instagram.com/humanwhocodes">Instagram</a></li>
                    <li><a href="https://www.youtube.com/channel/UC95Pwj8oPPZN2mJCEtMqOsg">YouTube</a></li>
                    <li><a href="https://www.linkedin.com/in/nzakas">LinkedIn</a></li>
                    <li><a href="https://www.slideshare.net/nzakas/presentations/">Slideshare</a></li>
                    <li><a href="https://amazon.com/author/nzakas/">Amazon</a></li>
                </ul>
            </div>
        </div>
        <p class="center-text"><a href="../../../../policies/privacy">Privacy Policy</a> | <a href="../../../../policies/terms">Terms of Service</a></p>
        <p class="center-text">Copyright &copy; 2004-2021 Human Who Codes LLC. Content licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/" rel="nofollow noopener">Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License</a>.<br>All code examples on all pages, unless otherwise indicated, are <a href="../../../../license">BSD licensed</a>.<br>Some links may be affiliate links. We may get paid if you buy something or take an action after clicking one of these. As an Amazon Associate we earn from qualifying purchases. <a href="../../../../feeds/blog.xml">Blog Feed</a></p>
    </div>
</footer>

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-6849003-1', 'auto');  // Replace with your property ID.
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
</body>
</html>

